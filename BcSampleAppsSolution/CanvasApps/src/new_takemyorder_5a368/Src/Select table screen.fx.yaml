"'Select table screen' As screen":
    Fill: =varTheme.secondaryColor
    LoadingSpinnerColor: =RGBA(100, 118, 132, 1)
    OnVisible: |-
        =Clear(colTablesWithStatus);
        Clear(colCachedSalesOrdersForTables);
        Clear(colSelectedItems);
        Clear(colOrderSummary);
        
        Set(varSelectedItemGroup, Blank());
        Set(varAddItemsToCurrentOrder, Blank());
        Set(varActiveorderForSelectedTable, Blank());
        
        // Ensure sales orders inlcude latest changes
        Refresh('salesOrders (v2.0)');
        
        // Cache sales orders to avoid calling connector in ForAll and only load needed columns
        UpdateContext({ctxCachedSalesOrders: ShowColumns('salesOrders (v2.0)', "customerId", "number")});
        
        ForAll(varTables, 
            // Collect is the only storage allowed in ForAll
            Collect(colCachedSalesOrdersForTables, LookUp(ctxCachedSalesOrders, customerId = id));
            Collect(colTablesWithStatus, {
                id: ThisRecord.id,
                displayName: ThisRecord.displayName,
                free: IsBlank(LookUp(colCachedSalesOrdersForTables, customerId = id)),
                orderNumber: LookUp(colCachedSalesOrdersForTables, customerId = id).number,
                customerId: LookUp(colCachedSalesOrdersForTables, customerId = id).customerId    
            });
        ); 

    conSelecTableContent As groupContainer.verticalAutoLayoutContainer:
        Height: =Parent.Height
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        Width: =Parent.Width
        ZIndex: =5

        lblSelectTableHeader As label:
            Align: =Align.Center
            BorderColor: =RGBA(32, 54, 71, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            Font: =Font.'Segoe UI'
            Height: =91
            LayoutMinHeight: =70
            LayoutMinWidth: =560
            Size: =30
            Text: ="Select Tables"
            Width: =Parent.Width
            X: =Parent.Width/2 - Self.Width/2
            Y: =20
            ZIndex: =1

        comDividerSelectTable As comBigDivider:
            Height: =16
            LayoutMinHeight: =640
            Width: =Parent.Width
            Y: =lblSelectTableHeader.Y + lblSelectTableHeader.Height
            ZIndex: =2

        "galTables As gallery.'BrowseLayout_Vertical_ThreeTextVariant_ver4.0'":
            BorderColor: =RGBA(32, 54, 71, 1)
            Height: =979
            Items: =colTablesWithStatus
            Layout: =Layout.Vertical
            LayoutMinHeight: =287
            LayoutMinWidth: =320
            OnSelect: |+
                =Clear(colSelectedItems);
                Set(varSelectedTable, ThisItem);
                
                If(varSelectedTable.free,
                    Set(varActiveorderForSelectedTable, Blank());
                    Navigate('Select Items Screen', ScreenTransition.Cover);
                    ,
                    Set(varActiveorderForSelectedTable, LookUp('salesOrders (v2.0)',number = varSelectedTable.orderNumber));
                    Navigate('Order Summary Screen', ScreenTransition.Cover);    
                );
                
            TemplatePadding: =0
            TemplateSize: =120
            Transition: =Transition.Pop
            Y: =
            ZIndex: =3

            recTableGallerySeperator As rectangle:
                BorderColor: =RGBA(32, 54, 71, 1)
                Fill: =Color.DarkGray
                Height: =2
                OnSelect: =Select(Parent)
                Width: =Parent.TemplateWidth - 40
                X: =20
                Y: =118
                ZIndex: =5

            lblTableStatus As label:
                BorderColor: =RGBA(32, 54, 71, 1)
                Color: =RGBA(0, 0, 0, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                Height: =lblTableName.Height
                OnSelect: =Select(Parent)
                Size: =21
                Text: =If(ThisItem.free, "Free", "Order placed")
                Width: =lblTableName.Width
                X: =lblTableName.X
                Y: =lblTableName.Height
                ZIndex: =7

            lblTableName As label:
                BorderColor: =RGBA(32, 54, 71, 1)
                Color: =RGBA(0, 0, 0, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                Height: =50
                OnSelect: =Select(Parent)
                Size: =21
                Text: =ThisItem.displayName
                Width: =Parent.TemplateWidth - 160
                X: =figStatusCircle.X + figStatusCircle.Width + 20
                Y: =10
                ZIndex: =8

            figStatusCircle As circle:
                BorderColor: =RGBA(32, 54, 71, 1)
                Fill: =If(ThisItem.free, Color.DarkGray, varTheme.primaryColor)
                Height: =60
                OnSelect: =Select(Parent)
                Width: =60
                X: =30 
                Y: =Parent.TemplateHeight/2 - Self.Height/2
                ZIndex: =10

            icnStatusPeople As icon.People:
                BorderColor: =RGBA(32, 54, 71, 1)
                Color: =Color.White
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(244, 244, 244, 1)
                Height: =40
                Icon: =Icon.People
                Visible: =Not(ThisItem.free)
                Width: =40
                X: =figStatusCircle.X + figStatusCircle.Width/2 - Self.Width/2
                Y: =figStatusCircle.Y + figStatusCircle.Height/2 - Self.Height/2
                ZIndex: =11

            icnSelectTable As icon.ChevronRight:
                BorderColor: =RGBA(32, 54, 71, 1)
                Color: =Color.DarkGray
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(244, 244, 244, 1)
                Height: =40
                Icon: =Icon.ChevronRight
                OnSelect: =Select(Parent)
                Width: =40
                X: =Parent.Width - Self.Width - 30
                Y: =Parent.TemplateHeight/2 - Self.Height/2
                ZIndex: =12

